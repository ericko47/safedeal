{% extends "core/base.html" %}
{% block content %}
<div class="flex items-center justify-center min-h-screen bg-gray-50">
  <div class="bg-white shadow-2xl rounded-2xl p-8 max-w-md w-full">

    {% comment %} <!-- Back link -->
    <a href="#" onclick="goBackWithSpinnerFix(event)" 
       class="inline-flex items-center text-sm text-gray-500 hover:text-blue-600 mb-6 transition">
      <svg xmlns="http://www.w3.org/2000/svg" 
           class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
      Back
    </a> {% endcomment %}

    <!-- Title -->
    <h2 class="text-2xl font-bold text-gray-800 text-center mb-6">Set New Password</h2>

    {% if validlink %}
      <form method="post" class="space-y-4">
        {% csrf_token %}
        
        <!-- Form fields -->
        {% for field in form %}
          <div>
            <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">
              {{ field.label }}
            </label>
            {{ field }}
            {% if field.errors %}
              <p class="text-red-600 text-sm mt-1">{{ field.errors|striptags }}</p>
            {% endif %}
          </div>
        {% endfor %}

        <!-- Button -->
        <button type="submit" 
                class="w-full bg-green-600 text-white font-semibold py-3 rounded-xl shadow hover:bg-green-700 transition">
          Change Password
        </button>
      </form>
    {% else %}
      <div class="text-center">
        <p class="text-red-600 mb-4">The password reset link is invalid or has already been used.</p>
        <a href="{% url 'password_reset' %}" 
           class="text-blue-600 hover:underline">Request a new reset link</a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
