
{% extends 'core/base.html' %}
{% load static %}

{% block title %}Rate Seller{% endblock %}

{% block content %}
<div class="max-w-lg mx-auto mt-8 bg-white shadow-md rounded-2xl p-6">
  <h2 class="text-xl font-semibold text-gray-800 mb-4 text-center">
    Leave a Rating
  </h2>

  <form method="post" class="space-y-4">
    {% csrf_token %}

    <!-- Score field with stars -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Rating</label>
      <div id="star-rating" class="flex space-x-1 cursor-pointer text-2xl text-gray-300">
        {% for i in "12345" %}
          <span data-value="{{ forloop.counter }}">â˜…</span>
        {% endfor %}
      </div>
      <input type="hidden" name="score" id="rating-score">
      <p id="rating-error" class="text-sm text-red-600 hidden">Please select a rating.</p>
    </div>

    <!-- Comment field -->
    <div>
      <label for="id_comment" class="block text-sm font-medium text-gray-700 mb-1">
        Comment
      </label>
      {{ form.comment }}
      {% for error in form.comment.errors %}
        <p class="text-sm text-red-600">{{ error }}</p>
      {% endfor %}
    </div>

    <!-- Submit button -->
    <div class="flex justify-center">
      <button type="submit" 
              class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded-2xl shadow">
        Submit Rating
      </button>
    </div>
  </form>
</div>

<!-- Script for handling star clicks -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const stars = document.querySelectorAll("#star-rating span");
    const scoreInput = document.getElementById("rating-score");
    const errorMsg = document.getElementById("rating-error");

    stars.forEach(star => {
      star.addEventListener("click", function () {
        const value = this.getAttribute("data-value");
        scoreInput.value = value;
        errorMsg.classList.add("hidden");

        // Highlight stars
        stars.forEach(s => {
          s.classList.remove("text-yellow-400");
          s.classList.add("text-gray-300");
        });
        for (let i = 0; i < value; i++) {
          stars[i].classList.remove("text-gray-300");
          stars[i].classList.add("text-yellow-400");
        }
      });
    });

    // Validate on submit
    document.querySelector("form").addEventListener("submit", function (e) {
      if (!scoreInput.value) {
        e.preventDefault();
        errorMsg.classList.remove("hidden");
      }
    });
  });
</script>

{% endblock %}
